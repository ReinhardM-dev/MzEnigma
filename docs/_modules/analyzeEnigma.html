<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>analyzeEnigma &mdash; MzEnigma V1.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MzEnigma
          </a>
              <div class="version">
                V1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../component.html">Enigma Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enigma.html">Enigma</a></li>
<li class="toctree-l1"><a class="reference internal" href="../predefined.html">Predefined Components and Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzeEnigma.html">Enigma Analysis</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MzEnigma</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Module code</a> &raquo;</li>
      <li>analyzeEnigma</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for analyzeEnigma</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. _CrypTool: https://www.cryptool.org/en/documentation/ctbook/</span>
<span class="sd">.. _Decrypted Secrets: https://link.springer.com/book/10.1007/978-3-540-48121-8</span>

<span class="sd">The cryptoanalysis methods implemented here include:</span>

<span class="sd">.. csv-table:: </span>
<span class="sd">   :header: &quot;Author&quot;, &quot;Requirement&quot;, &quot;See ...&quot;</span>
<span class="sd">   :widths: 15, 30, 30</span>
<span class="sd">   </span>
<span class="sd">   *Rejewski*, encoded Spruchschluessel, `Decrypted Secrets`_</span>
<span class="sd">   *Turing*, unencoded crib, `Decrypted Secrets`_</span>
<span class="sd">   *Gillogly*, language statistics, `CrypTool`_</span>
<span class="sd">   </span>
<span class="sd">None of these methods always succeed. As a rule of thumb, the</span>
<span class="sd">Turing and Gillogly attacks require at least 30 characters</span>
<span class="sd">to get sufficient analysis results.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">os.path</span>

<span class="kn">import</span> <span class="nn">networkx</span>

<span class="kn">import</span> <span class="nn">MzEnigma</span>

<div class="viewcode-block" id="TagesschluesselRange"><a class="viewcode-back" href="../analyzeEnigma.html#analyzeEnigma.TagesschluesselRange">[docs]</a><span class="k">class</span> <span class="nc">TagesschluesselRange</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
 <span class="sd">&quot;&quot;&quot;Represents a range of Tagesschluessel and analysis methods working on them</span>
<span class="sd"> </span>
<span class="sd">:param enigma: model of the Enigma (required)</span>
<span class="sd">:param umkehrwalzenList: &#39;Umkehrwalze&#39; (if undefined, randomly selected)</span>
<span class="sd">:param walzenList: List of type &#39;Walze&#39; (if undefined, randomly selecte(if undefined, randomly selected)</span>
<span class="sd">:param tagesWalzenStellungenList: List of Tageswalzenstellungen (if undefined, all) </span>
<span class="sd">:param spruchScoring: &#39;SpruchScoring&#39; (required by Gillolgy attack)</span>
<span class="sd">:param zusatzwalzenList: &#39;Zusatzwalze&#39; (if undefined, randomly selected)</span>
<span class="sd">:param blank: replacement character for a blank</span>
<span class="sd">:param notify: notification function (e.g. print)</span>
<span class="sd">  &quot;&quot;&quot;</span>
 <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
  <span class="n">enigma</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MzEnigma</span><span class="o">.</span><span class="n">Enigma</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  
  <span class="n">umkehrwalzenList</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">MzEnigma</span><span class="o">.</span><span class="n">Umkehrwalze</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
  <span class="n">walzenList</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">MzEnigma</span><span class="o">.</span><span class="n">Walze</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
  <span class="n">tagesWalzenStellungenList</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
  <span class="n">zusatzwalzenList</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">MzEnigma</span><span class="o">.</span><span class="n">Zusatzwalze</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
  <span class="n">spruchScoring</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MzEnigma</span><span class="o">.</span><span class="n">SpruchScoring</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
  <span class="n">blank</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>  
  <span class="n">notify</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notify</span> <span class="o">=</span> <span class="n">notify</span>
  <span class="k">assert</span> <span class="n">enigma</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: Enigma required&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span> <span class="o">=</span> <span class="n">enigma</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">blank</span> <span class="o">=</span> <span class="n">blank</span>
  <span class="n">alphabet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">alphabet</span>
  <span class="k">if</span> <span class="n">enigma</span><span class="o">.</span><span class="n">steckerbrett</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">steckerbrett</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">enigma</span><span class="o">.</span><span class="n">steckerbrett</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">notify</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">steckerbrett</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="k">assert</span> <span class="n">walzenList</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">walzenList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: WalzenRange is required&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">walzenList</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">walzenList</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
   <span class="n">walzenList</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">walzenList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">numberOfWalzen</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">walzenList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">_walzen</span> <span class="ow">in</span> <span class="n">walzenList</span><span class="p">:</span>
   <span class="n">walzen</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">_walze</span> <span class="ow">in</span> <span class="n">_walzen</span><span class="p">:</span>
    <span class="n">walze</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">_walze</span><span class="p">)</span>
    <span class="n">walze</span><span class="o">.</span><span class="n">notify</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span>
    <span class="n">walzen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_walze</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">walzenList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">walzen</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">tagesWalzenStellungenList</span><span class="p">:</span>
   <span class="k">for</span> <span class="n">tagesWalzenStellungen</span> <span class="ow">in</span> <span class="n">tagesWalzenStellungenList</span><span class="p">:</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tagesWalzenStellungen</span><span class="p">)</span> <span class="o">==</span> <span class="n">enigma</span><span class="o">.</span><span class="n">numberOfWalzen</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: Walzenstellung, number of characters must match the number of walzen&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">in</span> <span class="n">alphabet</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tagesWalzenStellungen</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: Walzenstellung, all characters must be in alphabet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="n">tagesWalzenStellungenList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span> <span class="n">repeat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">numberOfWalzen</span><span class="p">))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">tagesWalzenStellungenList</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tagesWalzenStellungenList</span> <span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">zusatzwalzenList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">enigma</span><span class="o">.</span><span class="n">zusatzwalzen</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
   <span class="k">assert</span> <span class="n">zusatzwalzenList</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: zusatzwalzenList is required&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">_walze</span> <span class="ow">in</span> <span class="n">zusatzwalzenList</span><span class="p">:</span>
    <span class="n">walze</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">_walze</span><span class="p">)</span>
    <span class="n">walze</span><span class="o">.</span><span class="n">notify</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zusatzwalzenList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">walze</span><span class="p">)</span>
  <span class="k">assert</span> <span class="n">umkehrwalzenList</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">umkehrwalzen</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: umkehrwalzenList is required&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">umkehrwalzenList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
   <span class="n">umkehrwalzenList</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">umkehrwalzen</span> <span class="p">]</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">umkehrwalzenList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">_walze</span> <span class="ow">in</span> <span class="n">umkehrwalzenList</span><span class="p">:</span>
   <span class="n">walze</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">_walze</span><span class="p">)</span>
   <span class="n">walze</span><span class="o">.</span><span class="n">notify</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">umkehrwalzenList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">walze</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span> <span class="o">=</span> <span class="n">spruchScoring</span> 
 
<div class="viewcode-block" id="TagesschluesselRange.rejewskiAttack"><a class="viewcode-back" href="../analyzeEnigma.html#analyzeEnigma.TagesschluesselRange.rejewskiAttack">[docs]</a> <span class="nd">@classmethod</span>
 <span class="k">def</span> <span class="nf">rejewskiAttack</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">catalog</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]],</span> <span class="n">encodedSpruchSchluessel</span> <span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
  <span class="sd">&quot;&quot;&quot;Find candidate values for the unencoded SpruchSchluessel from a catalog</span>

<span class="sd">:param catalog: catalog of encoded spruchschluessels (required)</span>
<span class="sd">:param encodedSpruchSchluessel: encoded spruchschluessels to be found (required)</span>
<span class="sd">:returns: List[Tuple[Tagesschluessel, unencodedSpruchSchluessel]]</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="bp">cls</span><span class="o">.</span><span class="n">checkRejewskiCatalog</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
  <span class="n">firstKey</span><span class="p">,</span> <span class="n">firstItem</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">alphabet</span> <span class="o">=</span> <span class="n">firstKey</span><span class="o">.</span><span class="n">alphabet</span>

  <span class="n">encodedPosKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">encodedSpruchSchluessel</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">firstItem</span><span class="p">)],</span> <span class="n">encodedSpruchSchluessel</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">firstItem</span><span class="p">):]):</span>
   <span class="n">encodedPosKeys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first</span><span class="o">+</span><span class="n">second</span><span class="p">)</span>
   
  <span class="n">validCandidates</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">tagesschluessel</span><span class="p">,</span> <span class="n">listOfDoublets</span> <span class="ow">in</span> <span class="n">catalog</span><span class="p">:</span>
   <span class="n">unencodedPosKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">doublets</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">listOfDoublets</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">encodedPosKeys</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doublets</span><span class="p">:</span>
     <span class="k">break</span>
    <span class="n">unencodedPosKeys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alphabet</span><span class="p">[</span><span class="n">doublets</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">encodedPosKeys</span><span class="p">[</span><span class="n">pos</span><span class="p">])])</span>
   <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unencodedPosKeys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">listOfDoublets</span><span class="p">):</span>
    <span class="n">validCandidates</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tagesschluessel</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unencodedPosKeys</span><span class="p">)))</span>
   
  <span class="k">return</span> <span class="n">validCandidates</span></div>

<div class="viewcode-block" id="TagesschluesselRange.createRejewskiCatalog"><a class="viewcode-back" href="../analyzeEnigma.html#analyzeEnigma.TagesschluesselRange.createRejewskiCatalog">[docs]</a> <span class="k">def</span> <span class="nf">createRejewskiCatalog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pickleFile</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]]:</span>
  <span class="sd">&quot;&quot;&quot;Build up a catalog of encoded spruchschluessels. Works only without a steckerbrett. </span>

<span class="sd">:param pickleFile: pickle file to be created (optional)</span>
<span class="sd">:returns: List[Tuple[Tagesschluessel, List[List[Doublet]]]</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">steckerbrett</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.createRejewskiCatalog: engines with steckerbrett are not supported&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">pickleFile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
   <span class="n">pickleFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">pickleFile</span><span class="p">)</span>
   <span class="k">assert</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">pickleFile</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.createRejewskiCatalog: pickle file </span><span class="si">{}</span><span class="s1"> is already exising&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">pickleFile</span><span class="p">)</span>
  <span class="n">gTagesschluessel</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">(</span><span class="n">enigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="p">,</span> <span class="n">notify</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
  <span class="n">rejewskiList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">umkehrwalze</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">umkehrwalzenList</span><span class="p">:</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.createRejewskiCatalog: - examining umkehrwalze = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">umkehrwalze</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
   <span class="k">for</span> <span class="n">walzen</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">walzenList</span><span class="p">:</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
     <span class="n">nameList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
     <span class="k">for</span> <span class="n">walze</span> <span class="ow">in</span> <span class="n">walzen</span><span class="p">:</span>
      <span class="n">nameList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">walze</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.createRejewskiCatalog:  - examining walzen = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">nameList</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">tagesWalzenStellungenID</span><span class="p">,</span> <span class="n">tagesWalzenStellungenTuple</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagesWalzenStellungenList</span><span class="p">):</span>
     <span class="n">tagesWalzenStellungen</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tagesWalzenStellungenTuple</span><span class="p">)</span>
     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.createRejewskiCatalog:   + examining tagesWalzenStellungen = </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> of </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">tagesWalzenStellungen</span><span class="p">,</span> <span class="n">tagesWalzenStellungenID</span><span class="p">,</span>  <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagesWalzenStellungenList</span><span class="p">)))</span>
     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zusatzwalzenList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">zusatzwalze</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zusatzwalzenList</span><span class="p">:</span>
       <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.createRejewskiCatalog:  - examining zusatzwalze = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">zusatzwalze</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
       <span class="n">tagesschluessel</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="o">.</span><span class="n">changeWalzen</span><span class="p">(</span>
                                  <span class="n">gTagesschluessel</span><span class="p">,</span> <span class="n">walzen</span> <span class="o">=</span> <span class="n">walzen</span><span class="p">,</span> <span class="n">tagesWalzenStellungen</span> <span class="o">=</span> <span class="n">tagesWalzenStellungen</span><span class="p">,</span> <span class="n">umkehrwalze</span> <span class="o">=</span> <span class="n">umkehrwalze</span><span class="p">,</span> <span class="n">zusatzwalze</span> <span class="o">=</span> <span class="n">zusatzwalze</span><span class="p">)</span>
       <span class="n">rejewskiList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tagesschluessel</span><span class="p">,</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">findDoublets</span><span class="p">(</span><span class="n">first</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">second</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">numberOfWalzen</span><span class="p">,</span> <span class="nb">all</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)))</span>
     <span class="k">else</span><span class="p">:</span>
      <span class="n">tagesschluessel</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="o">.</span><span class="n">changeWalzen</span><span class="p">(</span>
                                 <span class="n">gTagesschluessel</span><span class="p">,</span> <span class="n">walzen</span> <span class="o">=</span> <span class="n">walzen</span><span class="p">,</span> <span class="n">tagesWalzenStellungen</span> <span class="o">=</span> <span class="n">tagesWalzenStellungen</span><span class="p">,</span> <span class="n">umkehrwalze</span> <span class="o">=</span> <span class="n">umkehrwalze</span><span class="p">)</span>
      <span class="n">rejewskiList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tagesschluessel</span><span class="p">,</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">findDoublets</span><span class="p">(</span><span class="n">first</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">second</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">numberOfWalzen</span><span class="p">,</span> <span class="nb">all</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)))</span>
  <span class="k">if</span> <span class="n">pickleFile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
   <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span> <span class="n">rejewskiList</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span> <span class="n">pickleFile</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span> <span class="p">)</span> <span class="p">)</span>
  <span class="k">return</span> <span class="n">rejewskiList</span></div>
  
<div class="viewcode-block" id="TagesschluesselRange.checkRejewskiCatalog"><a class="viewcode-back" href="../analyzeEnigma.html#analyzeEnigma.TagesschluesselRange.checkRejewskiCatalog">[docs]</a> <span class="nd">@classmethod</span>
 <span class="k">def</span> <span class="nf">checkRejewskiCatalog</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">catalog</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]],</span> <span class="n">expectedSpruchschluesselLength</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;check a catalog of encoded spruchschluessels  </span>

<span class="sd">:param expectedSpruchschluesselLength: number of characters in unencoded spruchschluessel (optional)</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.checkRejewskiCatalog: empty catalog detected&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>  
  <span class="n">firstKey</span><span class="p">,</span> <span class="n">firstItem</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">firstKey</span><span class="p">,</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.checkRejewskiCatalog: improper catalog key, MzEnigma.Tagesschluessel espected&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">firstItem</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.checkRejewskiCatalogk: improper catalog item, list espected&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>  
  <span class="n">alphabet</span> <span class="o">=</span> <span class="n">firstKey</span><span class="o">.</span><span class="n">alphabet</span>
  <span class="k">if</span> <span class="n">expectedSpruchschluesselLength</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
   <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">firstItem</span><span class="p">)</span> <span class="o">==</span> <span class="n">expectedSpruchschluesselLength</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.checkRejewskiCatalog: number of positions in catalog item (</span><span class="si">{}</span><span class="s1">) != number of positions in spruchschluessel (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">firstItem</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">expectedSpruchschluesselLength</span><span class="p">)</span>  
  <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">firstItem</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">alphabet</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.checkRejewskiCatalog: number of positions in catalog item.item(</span><span class="si">{}</span><span class="s1">) != number of characters (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">firstItem</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">alphabet</span><span class="p">))</span>  
  <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">firstItem</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.checkRejewskiCatalog: improper catalog item.item, str espected&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>  </div>

<div class="viewcode-block" id="TagesschluesselRange.loadRejewskiCatalog"><a class="viewcode-back" href="../analyzeEnigma.html#analyzeEnigma.TagesschluesselRange.loadRejewskiCatalog">[docs]</a> <span class="nd">@classmethod</span>
 <span class="k">def</span> <span class="nf">loadRejewskiCatalog</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pickleFile</span> <span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]]:</span>
  <span class="sd">&quot;&quot;&quot;Build up a catalog of encoded spruchschluessels  </span>

<span class="sd">:returns: List[Tuple[Tagesschluessel, List[List[Doublet]]]</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">pickleFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">pickleFile</span><span class="p">)</span>
  <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">pickleFile</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.loadRejewskiCatalog: pickle file </span><span class="si">{}</span><span class="s1"> is not or not a file&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">pickleFile</span><span class="p">)</span>
  <span class="n">rejewskiList</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span> <span class="nb">open</span><span class="p">(</span> <span class="n">pickleFile</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span> <span class="p">)</span> <span class="p">)</span>
  <span class="bp">cls</span><span class="o">.</span><span class="n">checkRejewskiCatalog</span><span class="p">(</span><span class="n">rejewskiList</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">rejewskiList</span></div>

<div class="viewcode-block" id="TagesschluesselRange.turingAttack"><a class="viewcode-back" href="../analyzeEnigma.html#analyzeEnigma.TagesschluesselRange.turingAttack">[docs]</a> <span class="k">def</span> <span class="nf">turingAttack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encodedSpruch</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">crib</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">startingPosition</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]]:</span>
  <span class="sd">&quot;&quot;&quot;Turing attack to derive candidate settings for Umkehrwalze, Walzen, Zusatzwalze, Tageswalzenstellungen and several settings of the Steckerbrett</span>
<span class="sd">An engine with Steckerbrett is required.</span>
<span class="sd">The rate of correct Tagesschluessels increases with increasing length of the crib.</span>

<span class="sd">:param encodedSpruch: encoded message to be attacked (required)</span>
<span class="sd">:param crib: unencoded crib to be found in the message (required) </span>
<span class="sd">:param startingPosition: starting position of the crib in the message</span>
<span class="sd">:return: List[Tuple[Tagesschluessel, List[Tuple[Walzenstellungen, Steckerbrett.wiring]]]]</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">connectBus</span><span class="p">(</span><span class="nb">id</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">v</span> <span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
   <span class="sd">&#39;&#39;&#39;Heart of the turing bomb - the bus is restricted to the ONE active line with a character</span>
<span class="sd">   </span>
<span class="sd">   :param id: bus to be used</span>
<span class="sd">   :param v: input value</span>
<span class="sd">   :return: boolean indicating success</span>
<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">nonlocal</span> <span class="n">graph</span><span class="p">,</span> <span class="n">ecList</span><span class="p">,</span> <span class="n">buses</span>
   <span class="k">if</span> <span class="n">buses</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">buses</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="n">vID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">alphabet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tgtID</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
     <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">posDict</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="n">tgtID</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
      <span class="n">pos</span> <span class="o">=</span> <span class="n">posDict</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">]</span>
      <span class="n">tgtV</span> <span class="o">=</span> <span class="n">ecList</span><span class="p">[</span><span class="n">vID</span><span class="p">][</span><span class="n">pos</span><span class="p">]</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">connectBus</span><span class="p">(</span><span class="n">tgtID</span><span class="p">,</span> <span class="n">tgtV</span><span class="p">):</span>
       <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
   <span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">buses</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span>
   
  <span class="k">def</span> <span class="nf">getValidWalzenStellungen</span><span class="p">(</span><span class="n">tagesschluessel</span> <span class="p">:</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]]:</span> 
   <span class="k">nonlocal</span> <span class="n">ecList</span><span class="p">,</span> <span class="n">buses</span><span class="p">,</span> <span class="n">firstBus</span><span class="p">,</span> <span class="n">spruchLen</span><span class="p">,</span> <span class="n">graph</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.turingAttack: </span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">tagesschluessel</span><span class="p">))</span>
   <span class="n">oldTagesWalzenStellungen</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">tagesWalzenStellungen</span>
   <span class="n">candidateSteckerbrettList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">tagesWalzenStellungenID</span><span class="p">,</span> <span class="n">tagesWalzenStellungenTuple</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagesWalzenStellungenList</span><span class="p">):</span>
    <span class="n">knownWirings</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">tagesWalzenStellungen</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tagesWalzenStellungenTuple</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.turingAttack:  - examining tagesWalzenStellungen = </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> of </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">tagesWalzenStellungen</span><span class="p">,</span> <span class="n">tagesWalzenStellungenID</span><span class="p">,</span>  <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tagesWalzenStellungenList</span><span class="p">)))</span>
    <span class="n">ecList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">nc</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">alphabet</span><span class="p">):</span>
     <span class="n">ecList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">())</span>
     <span class="k">for</span> <span class="n">cs</span> <span class="ow">in</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">spruchLen</span> <span class="o">*</span> <span class="n">c</span><span class="p">):</span>
      <span class="n">ecList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">alphabet</span><span class="p">:</span>
     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.turingAttack:  + examining &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
     <span class="n">buses</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span> <span class="kc">None</span> <span class="p">]</span>
     <span class="k">if</span> <span class="n">connectBus</span><span class="p">(</span><span class="n">firstBus</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
      <span class="n">knownWiring</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
      <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">buses</span><span class="p">):</span>
       <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">knownWiring</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">alphabet</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">id</span>
      <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">knownWiring</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
      <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
       <span class="n">value</span> <span class="o">=</span> <span class="n">knownWiring</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
       <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="n">knownWiring</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
      <span class="n">knownWirings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">knownWiring</span><span class="p">)</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.turingAttack:   wiring </span><span class="si">{}</span><span class="s1"> found&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">knownWiring</span><span class="p">))</span>
    <span class="n">candidateSteckerbrettList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">tagesWalzenStellungen</span><span class="p">,</span> <span class="n">knownWirings</span><span class="p">))</span>
   <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">tagesWalzenStellungen</span> <span class="o">=</span> <span class="n">oldTagesWalzenStellungen</span>
   <span class="k">return</span> <span class="n">candidateSteckerbrettList</span>

  <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">steckerbrett</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.turingAttack: engines without steckerbrett are not supported&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="n">posList</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Enigma</span><span class="o">.</span><span class="n">validCribPositions</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">,</span> <span class="n">crib</span><span class="p">)</span>
  <span class="k">assert</span> <span class="n">startingPosition</span> <span class="ow">in</span> <span class="n">posList</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.turingAttack: </span><span class="si">{}</span><span class="s1"> is not a valid starting position, use in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">startingPosition</span><span class="p">,</span> <span class="n">posList</span><span class="p">)</span>
  <span class="n">encodedSpruch</span> <span class="o">=</span> <span class="n">encodedSpruch</span><span class="p">[</span><span class="n">startingPosition</span><span class="p">:]</span>
  <span class="n">ecList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="n">buses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  
  <span class="c1"># We need to use a MultiGraph, since the menu may contain duplicate edges (with different positions) </span>
  <span class="n">graph</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">MultiGraph</span><span class="p">()</span>

  <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">crib</span><span class="p">):</span>
   <span class="n">icc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">alphabet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
   <span class="n">iec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">alphabet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span>
   <span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">icc</span><span class="p">,</span> <span class="n">iec</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="p">)</span>
  <span class="n">firstBus</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">adjacency</span><span class="p">(),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 
  <span class="n">spruchLen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">crib</span><span class="p">)</span>
  <span class="n">encodedSpruch</span> <span class="o">=</span> <span class="n">encodedSpruch</span><span class="p">[:</span><span class="n">spruchLen</span><span class="p">]</span>
  
  <span class="n">gTagesschluessel</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">(</span><span class="n">enigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="p">,</span> 
                                                                 <span class="n">steckerbrett</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">MzEnigma</span><span class="o">.</span><span class="n">UnconnectedSteckerbrett</span><span class="p">),</span> 
                                                                 <span class="n">tagesWalzenStellungen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="o">.</span><span class="n">numberOfWalzen</span> <span class="o">*</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> 
                                                                 <span class="n">blank</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blank</span><span class="p">,</span> <span class="n">notify</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
  <span class="n">validCandidates</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">umkehrwalze</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">umkehrwalzenList</span><span class="p">:</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.turingAttack: - examining umkehrwalze = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">umkehrwalze</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
   <span class="k">for</span> <span class="n">walzen</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">walzenList</span><span class="p">:</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
     <span class="n">nameList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
     <span class="k">for</span> <span class="n">walze</span> <span class="ow">in</span> <span class="n">walzen</span><span class="p">:</span>
      <span class="n">nameList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">walze</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.turingAttack:  - examining walzen = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">nameList</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zusatzwalzenList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
     <span class="k">for</span> <span class="n">zusatzwalze</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zusatzwalzenList</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.turingAttack:  - examining zusatzwalze = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">zusatzwalze</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
      <span class="n">tagesschluessel</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="o">.</span><span class="n">changeWalzen</span><span class="p">(</span>
                                 <span class="n">gTagesschluessel</span><span class="p">,</span> <span class="n">walzen</span> <span class="o">=</span> <span class="n">walzen</span><span class="p">,</span> <span class="n">tagesWalzenStellungen</span> <span class="o">=</span> <span class="n">gTagesschluessel</span><span class="o">.</span><span class="n">tagesWalzenStellungen</span><span class="p">,</span> 
                                 <span class="n">umkehrwalze</span> <span class="o">=</span> <span class="n">umkehrwalze</span><span class="p">,</span> <span class="n">zusatzwalze</span> <span class="o">=</span> <span class="n">zusatzwalze</span><span class="p">)</span>
      <span class="n">candidateSteckerbrettList</span> <span class="o">=</span> <span class="n">getValidWalzenStellungen</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="p">)</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidateSteckerbrettList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
       <span class="n">validCandidates</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="p">),</span> <span class="n">candidateSteckerbrettList</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
     <span class="n">tagesschluessel</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="o">.</span><span class="n">changeWalzen</span><span class="p">(</span> 
                                <span class="n">gTagesschluessel</span><span class="p">,</span> <span class="n">walzen</span> <span class="o">=</span> <span class="n">walzen</span><span class="p">,</span> <span class="n">tagesWalzenStellungen</span> <span class="o">=</span> <span class="n">gTagesschluessel</span><span class="o">.</span><span class="n">tagesWalzenStellungen</span><span class="p">,</span> <span class="n">umkehrwalze</span> <span class="o">=</span> <span class="n">umkehrwalze</span><span class="p">)</span>
     <span class="n">candidateSteckerbrettList</span> <span class="o">=</span> <span class="n">getValidWalzenStellungen</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="p">)</span>
     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidateSteckerbrettList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">validCandidates</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="p">),</span> <span class="n">candidateSteckerbrettList</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">validCandidates</span></div>
  
<div class="viewcode-block" id="TagesschluesselRange.gilloglyAttackPhase1"><a class="viewcode-back" href="../analyzeEnigma.html#analyzeEnigma.TagesschluesselRange.gilloglyAttackPhase1">[docs]</a> <span class="k">def</span> <span class="nf">gilloglyAttackPhase1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encodedSpruch</span> <span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;Brute force attack to derive settings for Umkehrwalze, Walzen, Zusatzwalze, and Tageswalzenstellungen.</span>
<span class="sd">Uses the index of coincidence for scoring.</span>
<span class="sd">The rate of correct Tagesschluessels increases with increasing length of the encodedSpruch.</span>
<span class="sd"> </span>
<span class="sd">:param encodedSpruch: message to be attacked (required)</span>
<span class="sd">:return: Tagesschlüssel </span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">doScoring</span><span class="p">():</span>
   <span class="k">nonlocal</span> <span class="n">encodedSpruch</span><span class="p">,</span> <span class="n">bestScore</span><span class="p">,</span> <span class="n">tagesschluessel</span><span class="p">,</span> <span class="n">bestTagesschluessel</span><span class="p">,</span> <span class="n">lastDecryptedSpruch</span>
   <span class="n">decryptedSpruch</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">)</span>
   <span class="n">actScore</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">SpruchScoring</span><span class="o">.</span><span class="n">indexOfCoincidence</span><span class="p">(</span><span class="n">decryptedSpruch</span><span class="p">)</span>
   <span class="c1"># decryptedSpruchMD5 = hashlib.md5(str(decryptedSpruch).encode(&quot;utf-8&quot;)).hexdigest()</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.gilloglyAttackPhase1: + examining tagesWalzenStellungen = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">tagesWalzenStellungen</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> score = </span><span class="si">{:.3f}</span><span class="s1"> (best: </span><span class="si">{:.3f}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">actScore</span><span class="p">,</span> <span class="n">bestScore</span><span class="p">))</span>
   <span class="n">lastDecryptedSpruch</span> <span class="o">=</span> <span class="n">decryptedSpruch</span>
   <span class="k">if</span> <span class="n">actScore</span> <span class="o">&gt;</span> <span class="n">bestScore</span><span class="p">:</span>
    <span class="n">bestScore</span> <span class="o">=</span> <span class="n">actScore</span>
    <span class="n">bestTagesschluessel</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="p">)</span>
   
  <span class="n">lastDecryptedSpruch</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
  <span class="n">gTagesschluessel</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">(</span><span class="n">enigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enigma</span><span class="p">,</span> <span class="n">steckerbrett</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steckerbrett</span><span class="p">,</span> <span class="n">blank</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blank</span><span class="p">,</span> <span class="n">notify</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
  <span class="n">bestTagesschluessel</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="n">bestScore</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">umkehrwalze</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">umkehrwalzenList</span><span class="p">:</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.gilloglyAttackPhase1: - examining umkehrwalze = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">umkehrwalze</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
   <span class="k">for</span> <span class="n">walzen</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">walzenList</span><span class="p">:</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
     <span class="n">nameList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
     <span class="k">for</span> <span class="n">walze</span> <span class="ow">in</span> <span class="n">walzen</span><span class="p">:</span>
      <span class="n">nameList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">walze</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.gilloglyAttackPhase1:  - examining walzen = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">nameList</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">tagesWalzenStellungenTuple</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tagesWalzenStellungenList</span><span class="p">:</span>
     <span class="n">tagesWalzenStellungen</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tagesWalzenStellungenTuple</span><span class="p">)</span>
     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zusatzwalzenList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">zusatzwalze</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zusatzwalzenList</span><span class="p">:</span>
       <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.gilloglyAttackPhase1:  - examining zusatzwalze = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">zusatzwalze</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
       <span class="n">tagesschluessel</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="o">.</span><span class="n">changeWalzen</span><span class="p">(</span>
                                  <span class="n">gTagesschluessel</span><span class="p">,</span> <span class="n">walzen</span> <span class="o">=</span> <span class="n">walzen</span><span class="p">,</span> <span class="n">tagesWalzenStellungen</span> <span class="o">=</span> <span class="n">tagesWalzenStellungen</span><span class="p">,</span> <span class="n">umkehrwalze</span> <span class="o">=</span> <span class="n">umkehrwalze</span><span class="p">,</span> <span class="n">zusatzwalze</span> <span class="o">=</span> <span class="n">zusatzwalze</span><span class="p">)</span>
       <span class="n">doScoring</span><span class="p">()</span>
     <span class="k">else</span><span class="p">:</span>
      <span class="n">tagesschluessel</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="o">.</span><span class="n">changeWalzen</span><span class="p">(</span> 
                                 <span class="n">gTagesschluessel</span><span class="p">,</span> <span class="n">walzen</span> <span class="o">=</span> <span class="n">walzen</span><span class="p">,</span> <span class="n">tagesWalzenStellungen</span> <span class="o">=</span> <span class="n">tagesWalzenStellungen</span><span class="p">,</span> <span class="n">umkehrwalze</span> <span class="o">=</span> <span class="n">umkehrwalze</span><span class="p">)</span>
      <span class="n">doScoring</span><span class="p">()</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.gilloglyAttackPhase1: bestScore = </span><span class="si">{:.3f}</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>  <span class="n">bestScore</span><span class="p">,</span> <span class="n">bestTagesschluessel</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">bestTagesschluessel</span></div>

<div class="viewcode-block" id="TagesschluesselRange.shotgunPhase2"><a class="viewcode-back" href="../analyzeEnigma.html#analyzeEnigma.TagesschluesselRange.shotgunPhase2">[docs]</a> <span class="k">def</span> <span class="nf">shotgunPhase2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
   <span class="n">phase1Tagesschluessel</span> <span class="p">:</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">,</span> <span class="n">encodedSpruch</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">noImprovement</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;Shotgun hill climbing or simulated annealing attack to derive settings for Steckerbrett</span>
<span class="sd">Uses the &#39;newNgramScore&#39; for scoring.</span>
<span class="sd"> </span>
<span class="sd">:param phase1Tagesschluessel: tagesschluessel with correct settings for Umkehrwalze, Walzen, Zusatzwalze, and Tageswalzenstellungen(required)</span>
<span class="sd">:param encodedSpruch: encrypted message to be attacked (required)</span>
<span class="sd">:param noImprovement: stop condition after *noImprovement* number of attempts in a cycle</span>
<span class="sd">:return: Tagesschlüssel</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">fillWired</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="p">):</span>
   <span class="n">wired</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
   <span class="n">unwired</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">!=</span> <span class="n">c</span><span class="p">:</span>
     <span class="n">wired</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
     <span class="n">unwired</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">wired</span><span class="p">,</span> <span class="n">unwired</span>

  <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.shotgunPhase2: self.spruchScoring is required&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="k">assert</span> <span class="n">phase1Tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.gilloglyAttackPhase2: steckerbrett is required&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="n">wired</span><span class="p">,</span>  <span class="n">unwired</span> <span class="o">=</span> <span class="n">fillWired</span><span class="p">(</span><span class="n">phase1Tagesschluessel</span><span class="p">)</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wired</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
   <span class="k">return</span> <span class="n">phase1Tagesschluessel</span>
  <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">unwired</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.shotgunPhase2: steckerbrett with &gt; 0 unconnected pins required&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="n">tagesschluessel</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">phase1Tagesschluessel</span><span class="p">)</span>

  <span class="n">notImproved</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">bestScore</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">while</span> <span class="n">notImproved</span> <span class="o">&lt;</span> <span class="n">noImprovement</span><span class="p">:</span>
   <span class="n">actScore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">newNgramScore</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">),</span> <span class="n">bestScore</span><span class="p">,</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">actScore</span> <span class="o">&gt;=</span> <span class="n">bestScore</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">actScore</span> <span class="o">&gt;</span> <span class="n">bestScore</span><span class="p">:</span>
     <span class="n">notImproved</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">bestScore</span> <span class="o">=</span> <span class="n">actScore</span>
    <span class="n">bestWired</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">wired</span><span class="p">)</span>
    <span class="n">bestUnwired</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">unwired</span><span class="p">)</span>
    <span class="n">bestWiring</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.shotgunPhase2: bestScore = </span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">bestScore</span><span class="p">,</span> <span class="n">tagesschluessel</span><span class="p">))</span>
   <span class="k">else</span><span class="p">:</span>
    <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span> <span class="o">=</span> <span class="n">bestWiring</span>
    <span class="n">wired</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">bestWired</span><span class="p">)</span>
    <span class="n">unwired</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">bestUnwired</span><span class="p">)</span>
   <span class="n">notImproved</span> <span class="o">+=</span> <span class="mi">1</span>
   <span class="n">unconnectSrc</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">wired</span><span class="p">))</span>
   <span class="n">connectSrc</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">unwired</span><span class="p">))</span>
   <span class="n">unwired</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">connectSrc</span><span class="p">)</span>
   <span class="n">unwired</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">unconnectSrc</span><span class="p">)</span>
   <span class="n">connectTgt</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">unwired</span><span class="p">))</span>
   <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">clearMark3Setting</span><span class="p">(</span><span class="n">unconnectSrc</span><span class="p">)</span>
   <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">addMark3Setting</span><span class="p">(</span><span class="n">connectSrc</span><span class="p">,</span> <span class="n">connectTgt</span><span class="p">)</span>
   <span class="n">wired</span><span class="p">,</span>  <span class="n">unwired</span> <span class="o">=</span> <span class="n">fillWired</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">tagesschluessel</span></div>

<div class="viewcode-block" id="TagesschluesselRange.exchangePhase2"><a class="viewcode-back" href="../analyzeEnigma.html#analyzeEnigma.TagesschluesselRange.exchangePhase2">[docs]</a> <span class="k">def</span> <span class="nf">exchangePhase2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
   <span class="n">phase1Tagesschluessel</span> <span class="p">:</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">,</span> <span class="n">encodedSpruch</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cycles</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;Hill climbing based on exchange of x-connected ports of a steckerbrett</span>
<span class="sd"> </span>
<span class="sd">:param phase1Tagesschluessel: tagesschluessel with correct settings for Umkehrwalze, Walzen, Zusatzwalze, and Tageswalzenstellungen(required)</span>
<span class="sd">:param encodedSpruch: encrypted message to be attacked (required)</span>
<span class="sd">:param cycles: number of exchange cycles</span>
<span class="sd">:return: Tagesschlüssel</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.exchangePhase2: self.spruchScoring is required&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="k">assert</span> <span class="n">phase1Tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.gilloglyAttackPhase2: steckerbrett is required&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="n">tagesschluessel</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">phase1Tagesschluessel</span><span class="p">)</span>
  <span class="n">wired</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">!=</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">wired</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wired</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
   <span class="k">return</span> <span class="n">phase1Tagesschluessel</span>
  <span class="n">bestWiring</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span>
  <span class="n">bestScore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">ngramScore</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">),</span> <span class="n">validChars</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cycles</span><span class="p">):</span>
   <span class="n">frequencyDict</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">frequencyDict</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">,</span> <span class="n">decode</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">frequencyDict</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">frequencyDict</span><span class="p">[</span><span class="n">freq</span><span class="p">]:</span>
     <span class="k">if</span> <span class="n">c1</span> <span class="ow">in</span> <span class="n">wired</span><span class="p">:</span>
      <span class="n">c1Index</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">c1</span> <span class="o">!=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">[</span><span class="n">c1Index</span><span class="p">]:</span> 
       <span class="k">for</span> <span class="n">c2</span> <span class="ow">in</span> <span class="n">wired</span><span class="p">:</span>
        <span class="n">c2Index</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">c2</span> <span class="o">!=</span> <span class="n">c1</span> <span class="ow">and</span> <span class="n">c2</span> <span class="o">!=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">[</span><span class="n">c2Index</span><span class="p">]:</span>
         <span class="n">actWiring</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span>
         <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">exchangeMark3Setting</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>
         <span class="n">actScore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">ngramScore</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">),</span> <span class="n">validChars</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">actScore</span> <span class="o">&gt;</span> <span class="n">bestScore</span><span class="p">:</span>
          <span class="n">bestScore</span> <span class="o">=</span> <span class="n">actScore</span>
          <span class="n">bestWiring</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span>
          <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.exchangePhase2: cycle </span><span class="si">{}</span><span class="s1">, exchanging </span><span class="si">{}</span><span class="s1"> &lt;-&gt; </span><span class="si">{}</span><span class="s1">, score = </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">cycle</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">bestScore</span><span class="p">))</span>
         <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span> <span class="o">=</span> <span class="n">actWiring</span>
   <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span> <span class="o">=</span> <span class="n">bestWiring</span>
  <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span> <span class="o">=</span> <span class="n">bestWiring</span>
  <span class="k">return</span> <span class="n">tagesschluessel</span></div>

<div class="viewcode-block" id="TagesschluesselRange.gilloglyAttackPhase2"><a class="viewcode-back" href="../analyzeEnigma.html#analyzeEnigma.TagesschluesselRange.gilloglyAttackPhase2">[docs]</a> <span class="k">def</span> <span class="nf">gilloglyAttackPhase2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
   <span class="n">phase1Tagesschluessel</span> <span class="p">:</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">,</span> <span class="n">encodedSpruch</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> 
      <span class="n">noImprovement</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">cycles</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>  <span class="n">useSimulatedAnnealing</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;Shotgun hill climbing or simulated annealing attack to derive settings for Steckerbrett</span>
<span class="sd"> </span>
<span class="sd">:param phase1Tagesschluessel: tagesschluessel with correct settings for Umkehrwalze, Walzen, Zusatzwalze, and Tageswalzenstellungen(required)</span>
<span class="sd">:param encodedSpruch: encrypted message to be attacked (required)</span>
<span class="sd">:param noImprovement: stop condition after *noImprovement* number of attempts in a cycle</span>
<span class="sd">:param cycles: number of cycles with a random steckerbrett configuration</span>
<span class="sd">:param useSimulatedAnnealing: use simulated annealing instead of conventional hill climbing</span>
<span class="sd">:return: Tagesschlüssel</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">if</span> <span class="n">useSimulatedAnnealing</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">setSATemperature</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">setSATemperature</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="n">bestScore</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">tagesschluessel</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">phase1Tagesschluessel</span><span class="p">)</span>
  <span class="n">initialScore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">ngramScore</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">validChars</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
  <span class="n">bestWiring</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span>
  
  <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cycles</span><span class="p">):</span>
   <span class="n">tagesschluessel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shotgunPhase2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tagesschluessel</span><span class="p">,</span> <span class="n">encodedSpruch</span><span class="p">,</span>  <span class="n">noImprovement</span><span class="p">)</span>
   <span class="n">actScore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">newNgramScore</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">),</span> <span class="n">bestScore</span><span class="p">,</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.gilloglyAttackPhase2/cycle </span><span class="si">{}</span><span class="s1">: score = </span><span class="si">{:.3f}</span><span class="s1"> (best: </span><span class="si">{:.3f}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">cycle</span><span class="p">,</span> <span class="n">actScore</span><span class="p">,</span> <span class="n">bestScore</span><span class="p">))</span>
   <span class="k">if</span> <span class="n">actScore</span> <span class="o">&gt;</span> <span class="n">bestScore</span><span class="p">:</span>
    <span class="n">bestScore</span> <span class="o">=</span> <span class="n">actScore</span>
    <span class="n">bestWiring</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span>
   <span class="n">newSteckerbrett</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Steckerbrett</span><span class="o">.</span><span class="n">Mark_3</span><span class="p">(</span><span class="n">alphabet</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
   <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span> <span class="o">=</span> <span class="n">newSteckerbrett</span><span class="o">.</span><span class="n">wiring</span>
  <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span> <span class="o">=</span> <span class="n">bestWiring</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
   <span class="n">finalScore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">ngramScore</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">validChars</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.gilloglyAttackPhase2: score </span><span class="si">{:.3f}</span><span class="s1"> -&gt; </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">initialScore</span><span class="p">,</span> <span class="n">finalScore</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">tagesschluessel</span></div>

<div class="viewcode-block" id="TagesschluesselRange.mzAttackPhase2"><a class="viewcode-back" href="../analyzeEnigma.html#analyzeEnigma.TagesschluesselRange.mzAttackPhase2">[docs]</a> <span class="k">def</span> <span class="nf">mzAttackPhase2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase1Tagesschluessel</span> <span class="p">:</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">,</span> <span class="n">encodedSpruch</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">Tagesschluessel</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;Systematic hill climbing attack to derive settings for Steckerbrett</span>
<span class="sd">Uses the &#39;ngramScore&#39; for scoring.</span>
<span class="sd"> </span>
<span class="sd">:param phase1Tagesschluessel: tagesschluessel with correct settings for Umkehrwalze, Walzen, Zusatzwalze, and Tageswalzenstellungen(required)</span>
<span class="sd">:param encodedSpruch: encrypted message to be attacked (required)</span>
<span class="sd">:return: Tagesschlüssel</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.mzAttackPhase2: self.spruchScoring is required&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="k">assert</span> <span class="n">phase1Tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.mzAttackPhase2: steckerbrett is required&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="n">tagesschluessel</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">phase1Tagesschluessel</span><span class="p">)</span>
  <span class="n">nConnections</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">!=</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">nConnections</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="n">nConnections</span> <span class="o">=</span> <span class="n">nConnections</span> <span class="o">//</span> <span class="mi">2</span>
  <span class="k">assert</span> <span class="n">nConnections</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.mzAttackPhase2: at least one connection in steckerbrett required&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
  <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span>
  <span class="n">monograms</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">ngramDict</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">c2s</span><span class="p">:</span> <span class="n">c2s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
  <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">monograms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="o">*</span><span class="n">nConnections</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.mzAttackPhase2: len(monograms) = </span><span class="si">{}</span><span class="s1"> &gt; 2*nConnections = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">monograms</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">nConnections</span><span class="p">)</span>
  <span class="n">initialScore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">ngramScore</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">validChars</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
  <span class="n">unwired</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">numberOfChars</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="n">connectedChars</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
  <span class="n">connection</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">while</span> <span class="n">connection</span> <span class="o">&lt;</span> <span class="n">nConnections</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">unwired</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
   <span class="n">connectTgt</span> <span class="o">=</span> <span class="n">monograms</span><span class="o">.</span><span class="n">pop</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
   <span class="n">connectedChars</span> <span class="o">+=</span> <span class="n">connectTgt</span>
   <span class="k">if</span> <span class="n">connectTgt</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unwired</span><span class="p">:</span>
    <span class="k">continue</span>
   <span class="n">maxScore</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="n">maxN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
   <span class="n">wiring</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span>
   <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">connectSrc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unwired</span><span class="p">):</span>
    <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span> <span class="o">=</span> <span class="n">wiring</span>
    <span class="k">if</span> <span class="n">connectSrc</span> <span class="o">!=</span> <span class="n">connectTgt</span><span class="p">:</span>
     <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">addMark3Setting</span><span class="p">(</span><span class="n">connectSrc</span><span class="p">,</span> <span class="n">connectTgt</span><span class="p">)</span>
    <span class="n">decodedSpruch</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">)</span>
    <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
     <span class="n">actScore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">ngramScore</span><span class="p">(</span><span class="n">decodedSpruch</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">validChars</span> <span class="o">=</span> <span class="n">connectedChars</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
     <span class="n">actScore</span> <span class="o">=</span> <span class="n">MzEnigma</span><span class="o">.</span><span class="n">SpruchScoring</span><span class="o">.</span><span class="n">indexOfCoincidence</span><span class="p">(</span><span class="n">decodedSpruch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">actScore</span> <span class="o">&gt;</span> <span class="n">maxScore</span><span class="p">:</span>
     <span class="n">maxScore</span> <span class="o">=</span> <span class="n">actScore</span>
     <span class="n">maxN</span> <span class="o">=</span> <span class="n">n</span>
   <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">wiring</span> <span class="o">=</span> <span class="n">wiring</span>
   <span class="n">connectSrc</span> <span class="o">=</span> <span class="n">unwired</span><span class="p">[</span><span class="n">maxN</span><span class="p">]</span>
   <span class="n">unwired</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">unwired</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">connectSrc</span><span class="p">))</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.mzAttackPhase2: connecting </span><span class="si">{}</span><span class="s1"> -&gt; </span><span class="si">{}</span><span class="s1">, maxScore = </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">connectSrc</span><span class="p">,</span> <span class="n">connectTgt</span><span class="p">,</span> <span class="n">maxScore</span><span class="p">))</span>
   <span class="k">if</span> <span class="n">connectSrc</span> <span class="o">!=</span> <span class="n">connectTgt</span><span class="p">:</span>
    <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">steckerbrett</span><span class="o">.</span><span class="n">addMark3Setting</span><span class="p">(</span><span class="n">connectSrc</span><span class="p">,</span> <span class="n">connectTgt</span><span class="p">)</span>
    <span class="n">unwired</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">unwired</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">connectTgt</span><span class="p">))</span>
    <span class="n">connection</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">:</span>
   <span class="n">finalScore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spruchScoring</span><span class="o">.</span><span class="n">ngramScore</span><span class="p">(</span><span class="n">tagesschluessel</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encodedSpruch</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">validChars</span> <span class="o">=</span> <span class="n">tagesschluessel</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.mzAttackPhase2: score </span><span class="si">{:.3f}</span><span class="s1"> -&gt; </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">initialScore</span><span class="p">,</span> <span class="n">finalScore</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">tagesschluessel</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Reinhard März.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>